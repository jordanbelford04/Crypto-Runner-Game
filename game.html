<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <title>Crypto Runner Game</title>

  <style>

    body { margin: 0; }

    canvas { display: block; }

    #coin-counter {

      position: absolute;

      top: 10px;

      left: 50%;

      transform: translateX(-50%);

      font-size: 24px;

      color: white;

    }

    #hearts {

      position: absolute;

      top: 10px;

      right: 10px;

    }

    .heart {

      width: 20px;

      height: 20px;

      background-color: red;

      display: inline-block;

      margin: 0 2px;

    }

  </style>

</head>

<body>

<canvas id="gameCanvas"></canvas>

<div id="coin-counter">Монеты: 0</div>

<div id="hearts"></div>

<script>

  const canvas = document.getElementById('gameCanvas');

  const ctx = canvas.getContext('2d');

  canvas.width = window.innerWidth;

  canvas.height = window.innerHeight;



  const characters = {

    cyborg: {

      image: new Image(),

      src: 'cyborg.png',

      superpower: 'turbo',

      jumpHeight: 20,

      gravity: 0.8

    },

    cat: {

      image: new Image(),

      src: 'cat.png',

      superpower: 'antigravity',

      jumpHeight: 20,

      gravity: 0.6

    },

    dragon: {

      image: new Image(),

      src: 'dragon.png',

      superpower: 'fireShield',

      jumpHeight: 20,

      gravity: 1.0

    }

  };



  let character = {

    x: 50,

    y: canvas.height - 100,

    width: 50,

    height: 50,

    yVelocity: 0,

    onGround: false,

    image: null

  };



  let obstacles = [];

  let coins = [];

  let hearts = [];

  let score = 0;

  let lives = 3;

  let maxLives = 5;

  let powerActive = false;

  let powerTimer = 0;

  let lastHeartTime = Date.now();



  function initGame(selectedCharacter) {

    character.image = characters[selectedCharacter].image;

    character.image.src = characters[selectedCharacter].src;

  }



  function drawCharacter() {

    if (character.image) {

      ctx.drawImage(character.image, character.x, character.y, character.width, character.height);

    }

  }



  function updateCharacter() {

    character.yVelocity += characters[selectedCharacter].gravity;

    character.y += character.yVelocity;



    if (character.y + character.height > canvas.height - 50) { // -50 to account for the ground

      character.y = canvas.height - character.height - 50;

      character.yVelocity = 0;

      character.onGround = true;

    }

  }



  function createObstacle() {

    let types = [

      { width: 50, height: 50, color: 'red' },

      { width: 30, height: 70, color: 'orange' },

      { width: 70, height: 30, color: 'purple' }

    ];

    let type = types[Math.floor(Math.random() * types.length)];

    let obstacle = {

      x: canvas.width,

      y: canvas.height - type.height - 50, // -50 to account for the ground

      width: type.width,

      height: type.height,

      color: type.color

    };

    obstacles.push(obstacle);

  }



  function createCoin() {

    let coin = {

      x: canvas.width,

      y: Math.random() * (canvas.height - 100),

      radius: 15

    };

    coins.push(coin);

  }



  function createHeart() {

    let heart = {

      x: canvas.width,

      y: Math.random() * (canvas.height - 100),

      radius: 15

    };

    hearts.push(heart);

  }



  function drawObstacles() {

    obstacles.forEach(obstacle => {

      ctx.fillStyle = obstacle.color;

      ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);

    });

  }



  function drawCoins() {

    ctx.fillStyle = 'yellow';

    coins.forEach(coin => {

      ctx.beginPath();

      ctx.arc(coin.x, coin.y, coin.radius, 0, Math.PI * 2);

      ctx.fill();

    });

  }



  function drawHearts() {

    ctx.fillStyle = 'pink';

    hearts.forEach(heart => {

      ctx.beginPath();

      ctx.arc(heart.x, heart.y, heart.radius, 0, Math.PI * 2);

      ctx.fill();

    });

  }



  function updateObstacles() {

    obstacles.forEach(obstacle => {

      obstacle.x -= 5;

    });

    obstacles =

obstacles.filter(obstacle => obstacle.x + obstacle.width > 0);

  }



  function updateCoins() {

    coins.forEach(coin => {

      coin.x -= 5;

    });

    coins = coins.filter(coin => coin.x + coin.radius > 0);

  }



  function updateHearts() {

    hearts.forEach(heart => {

      heart.x -= 5;

    });

    hearts = hearts.filter(heart => heart.x + heart.radius > 0);

  }



  function detectCollisions() {

    obstacles.forEach(obstacle => {

      if (character.x < obstacle.x + obstacle.width &&

        character.x + character.width > obstacle.x &&

        character.y < obstacle.y + obstacle.height &&

        character.y + character.height > obstacle.y) {

        if (!powerActive || characters[selectedCharacter].superpower !== 'fireShield') {

          lives--;

          updateHeartsDisplay(lives);

          if (lives === 0) {

            alert('Game Over');

            document.location.reload();

          }

        }

      }

    });



    coins.forEach(coin => {

      if (character.x < coin.x + coin.radius &&

        character.x + character.width > coin.x &&

        character.y < coin.y + coin.radius &&

        character.y + character.height > coin.y) {

        score += 10;

        updateCoinCounter(10);

        coins = coins.filter(c => c !== coin);

        playSound('coin');

      }

    });



    hearts.forEach(heart => {

      if (character.x < heart.x + heart.radius &&

        character.x + character.width > heart.x &&

        character.y < heart.y + heart.radius &&

        character.y + character.height > heart.y) {

        if (lives < maxLives) {

          lives++;

          updateHeartsDisplay(lives);

        }

        hearts = hearts.filter(h => h !== heart);

        playSound('heart');

      }

    });

  }



  function activatePower() {

    powerActive = true;

    powerTimer = 100; // Example timer value

    document.body.style.backgroundColor = 'lightcoral'; // Change background color when power is active

    playSound('power');

    if (characters[selectedCharacter].superpower === 'turbo') {

      // Implement turbo speed and invincibility

    } else if (characters[selectedCharacter].superpower === 'antigravity') {

      // Implement anti-gravity

    } else if (characters[selectedCharacter].superpower === 'fireShield') {

      // Implement fire shield

    }

  }



  function deactivatePower() {

    powerActive = false;

    powerTimer = 0;

    document.body.style.backgroundColor = ''; // Reset background color

  }



  function handlePowers() {

    if (powerActive) {

      powerTimer--;

      if (powerTimer <= 0) {

        deactivatePower();

      }

    }

  }



  function playSound(type) {

    let audio = new Audio();

    if (type === 'jump') {

      audio.src = 'jump.mp3';

    } else if (type === 'power') {

      audio.src = 'power.mp3';

    } else if (type === 'coin') {

      audio.src = 'coin.mp3';

    } else if (type === 'heart') {

      audio.src = 'heart.mp3';

    }

    audio.play();

  }



  function updateCoinCounter(coins) {

    totalCoins += coins;

    document.getElementById('coin-counter').textContent = `Монеты: ${totalCoins}`;

  }



  function updateHeartsDisplay(lives) {

    const heartsContainer = document.getElementById('hearts');

    heartsContainer.innerHTML = '';

    for (let i = 0; i < lives; i++) {

      const heart = document.createElement('div');

      heart.className = 'heart';

      heartsContainer.appendChild(heart);

    }

  }



  function gameLoop() {

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = 'black';

    ctx.fillRect(0, canvas.height - 50, canvas.width, 50); // Drawing the ground



    drawCharacter();

    drawObstacles();

    drawCoins();

    drawHearts();



    updateCharacter();

    updateObstacles();

    updateCoins();

    updateHearts();

    detectCollisions();

    handlePowers();



    requestAnimationFrame(gameLoop);

  }



  window.addEventListener('keydown', (e) => {

    if (e.code === 'Space' && character.onGround) {

      character.yVelocity = -characters[selectedCharacter].jumpHeight;

      character.onGround = false;

      playSound('jump');

    } else if (e.code === 'KeyP') { // Нажатие 'P' активирует суперсилу

      activatePower();

    }

  });



  setInterval(createObstacle, 2000);

  setInterval(createCoin, 3000);

  setInterval(() => {

    if (Date.now() - lastHeartTime > 60000) { // Example interval for heart appearance

      createHeart();

      lastHeartTime = Date.now();

    }

  }, 1000);



  updateHeartsDisplay(lives);

  gameLoop();

</script>

</body>

</html>